{"triggers":[],"nodes":[{"uid":"2b6a4c9d-1f46-46b7-9234-930697c2d766","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"8c166d58-d7d8-471a-a498-2cd0ccc696c0","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"name":"find","value":{"type":"STRING","string":"^\\\\(.+\\\\)*(.+)\\\\(.+)"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$sRegexBlock$"}}],"returnTo":{"type":"VARIABLE","variableName":"sTaskName"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"変数初期化"}}]},{"uid":"9c72789c-6ac1-40ba-80a2-f321d460bd4d","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"ffdc73b8-d193-4d0f-b8f1-678a4f643126","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"a089e1d7-9108-4185-990f-9f50bb85f9d5","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditFolderPath$/$sAuditFileName$.txt"}},{"name":"logContent","value":{"type":"STRING","expression":",$sTaskName$,後処理開始"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Audit Trail出力"}}]},{"uid":"9c67b5af-ed4b-437e-a4c4-905ca3851dde","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"fa264119-2c93-4019-b4d2-f421297bd567","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"正常終了"}}]},{"uid":"ce91c816-12e2-4505-90b8-7a75d03c10f3","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"68b8b71a-110a-45df-bbee-044538d863cd","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditFolderPath$/$sAuditFileName$.txt"}},{"name":"logContent","value":{"type":"STRING","expression":",$sTaskName$,正常終了処理"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Audit Trail出力"}}]},{"uid":"27b6ec9b-678d-40df-a7b4-14f82816fc56","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"348e2fe3-d636-420b-8331-c877ac5968be","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sAddressTo$"}},{"name":"cc","value":{"type":"STRING","expression":"$sAddressCc$"}},{"name":"bcc","value":{"type":"STRING","expression":"$sAddressBcc$"}},{"name":"subject","value":{"type":"STRING","string":"Botが正常終了しました"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$sAuditFolderPath$/$sAuditFileName$.txt"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","string":"Botが正常終了しました"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]},{"uid":"ddfb132b-5dae-48c6-b823-2717b825754d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"メールで送信した場合のみ、ローカルのAudit Trail Logを削除"}}]},{"uid":"0fcf187a-f87c-4043-8701-d8f0285a37c0","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditFolderPath$/$sAuditFileName$.txt"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sAddressFrom$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sAddressTo$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"5b7affe3-b150-4f23-9e06-fd1faa875c1f","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"4320e9b2-12c0-4d47-bb71-af344c99d191","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"異常終了"}}]},{"uid":"8ac8f02e-7a2d-4264-9203-6376dda320c6","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"b9eaef6c-60ac-4f28-a683-f7146cf4d37f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditFolderPath$/$sAuditFileName$.txt"}},{"name":"logContent","value":{"type":"STRING","expression":",$sTaskName$,異常終了処理"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Audit Trail出力"}}]},{"uid":"0945b140-d742-490b-b073-0e534816da5a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"bfe5223b-f268-4db6-beed-e1673998cba7","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"14fa7528-ea6f-4a3d-aede-c1d49966f0f6","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"5dc96ead-ebba-4bf8-a82b-04ab90dd20e0","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditFolderPath$/$sAuditFileName$.txt"}},{"name":"logContent","value":{"type":"STRING","expression":",$sTaskName$,ログフォルダがないため作成"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Audit Trail出力"}}]},{"uid":"d5db281d-7716-4e3d-a20e-494b9855eae0","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sErrorFolderPath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sErrorFolderPath$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"b836cb49-eb6c-4040-b069-6bd09ffcf0fa","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sErrorFolderPath$/$sErrorFileName$.txt"}},{"name":"logContent","value":{"type":"STRING","string":"時刻,Bot名,エラー発生行,エラー内容"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"6ad24c5a-3050-4f18-b34c-404bf3dd6166","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sErrorFolderPath$/$sErrorFileName$.txt"}},{"name":"logContent","value":{"type":"STRING","expression":",$sErrMsg$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"68afebdb-346b-46ba-a183-b512287eb2a0","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"3105c77f-37da-4ba5-a04c-b0a9f185113c","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditFolderPath$/$sAuditFileName$.txt"}},{"name":"logContent","value":{"type":"STRING","expression":",$sTaskName$,エラー内容をログに記載"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Audit Trail出力"}}]},{"uid":"25857a07-26aa-4480-9942-6a866b7d58b2","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sErrorFolderPath$/$sErrorFileName$.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"b80608e5-3e9c-4de2-ba83-778139f7d55c","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"0bf03397-3cc7-4848-bb56-f7cbfaf48f2b","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditFolderPath$/$sAuditFileName$.txt"}},{"name":"logContent","value":{"type":"STRING","expression":",$sTaskName$,キャプチャ取得完了"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Audit Trail出力"}}]},{"uid":"372250a1-85a4-45f7-9c85-0520f61afaec","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c87b9fcd-c0da-4416-a2dd-3fc699927783","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$sAddressTo$"}},{"name":"cc","value":{"type":"STRING","expression":"$sAddressCc$"}},{"name":"bcc","value":{"type":"STRING","expression":"$sAddressBcc$"}},{"name":"subject","value":{"type":"STRING","string":"Botが異常終了しました"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$sAuditFolderPath$/$sAuditFileName$.txt%3B$sErrorFolderPath$/$sErrorFileName$.txt%3B$sErrorFolderPath$/$sErrorFileName$.png"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","string":"Botが異常終了しました。\n添付ファイルをご確認ください。"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":true}},{"name":"serverType","value":{"type":"STRING","string":"OUTLOOK"}}]},{"uid":"73086ffb-048a-448b-9f0e-cd0863c237b8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"メールで送信した場合のみローカルのログとキャプチャを削除"}}]},{"uid":"05ddf6ce-f881-4493-9a6a-1531d3394a39","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sErrorFolderPath$/$sErrorFileName$.txt"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"aaad6866-2cc8-435a-a901-57e7e38616de","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sErrorFolderPath$/$sErrorFileName$.png"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"a17da59f-3207-4f27-8d2e-693ca0e3a36f","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sAuditFolderPath$/$sAuditFileName$.txt"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sAddressFrom$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sAddressTo$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"エラーログ/キャプチャ処理"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sErrMsg$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"07b3e24b-2476-4116-8ab5-2258949384b4","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"bb9c7da7-b782-423e-adcf-6d5aec6832f0","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrLineNo$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrLineNo"}},{"uid":"b91cea62-4500-4b7c-bfcc-6732c351c487","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"Bot名:$sTaskName$,エラー行:$sErrLineNo$,エラー内容:$sErrMsg$"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrMsg"}},{"uid":"764d3f86-556c-487a-aa66-6767daa4c63f","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","expression":"$sErrMsg$"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrMsg"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrLineNo"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"sErrorFileName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sErrorFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sErrMsg","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sAddressFrom","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sAddressTo","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sAddressCc","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sAddressBcc","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"nErrLineNo","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sErrLineNo","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sRegexBlock","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"$3"}},{"name":"sTaskName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sAuditFolderPath","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sAuditFileName","description":"","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Email","version":"3.0.0-20200901-105426"},{"name":"If","version":"2.1.0-20200825-071156"},{"name":"Step","version":"2.0.0-20200907-072944"},{"name":"ErrorHandler","version":"2.1.0-20200831-031055"},{"name":"Comment","version":"2.1.0-20200831-031015"},{"name":"System","version":"3.0.0-20200831-031944"},{"name":"Screen","version":"2.1.0-20200825-071618"},{"name":"File","version":"2.2.0-20200831-031057"},{"name":"LogToFile","version":"2.2.0-20200831-031539"},{"name":"Folder","version":"2.2.0-20200831-031100"},{"name":"Number","version":"2.1.0-20200831-031551"},{"name":"String","version":"3.1.0-20200831-031943"}],"workItemTemplateName":null}