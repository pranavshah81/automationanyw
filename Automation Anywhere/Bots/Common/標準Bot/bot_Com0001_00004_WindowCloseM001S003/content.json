{"triggers":[],"nodes":[{"uid":"6107866a-0532-42dc-bed6-098ce38dac5c","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"8a994c49-6d00-473d-8c89-d465cc4bf29a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"ecec2867-8896-4f00-a412-4bedb393c721","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：処理プロセス名(ログファイルで表示)"}}]},{"uid":"0987328c-cc6b-4f21-940e-950dacbc6aa6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Windowクローズ"}}],"returnTo":{"type":"VARIABLE","variableName":"strSyoriTitle"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"初期設定(開発者設定)"}}]},{"uid":"ca1b7cdb-889c-4c04-aa05-e9a8b101461a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"d6623988-20e7-446f-a0b6-cb6e43c1ae68","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：子Bot(Sub Task)"}}]},{"uid":"fe0b4957-0770-419d-98ef-1e1e26c5fa23","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"name":"find","value":{"type":"STRING","string":"^/(.+/)*(.+)/(.+)"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$strBlock$"}}],"returnTo":{"type":"VARIABLE","variableName":"strTaskName"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"初期設定(固定値)"}}]},{"uid":"750d4c06-0a1d-42ea-a88b-32c0471b6efe","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：開始ログ取得"}}]},{"uid":"a0ca49cf-4402-4fe7-b90c-fb1f58709bd1","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,$strSyoriTitle$処理開始,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"cf6d05e2-2685-4693-961b-7acc72543ae3","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"06ab2e62-4396-4043-8160-4a5c1dd64fd0","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"85a10398-89c6-4d1b-8b37-71a66c7c0a73","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：終了ログ取得"}}]},{"uid":"4f1bf6f8-72b6-4207-ba47-7eaba514d3ba","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,Close対象のアプリケーションがありませんでした、$strSyoriTitle$処理終了,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"73f61b3d-2da1-4cb1-be88-46c9599a065d","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strCloseApp$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"63616a1e-031c-48b6-8af8-b41d5b265990","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f827ad46-0c97-47a9-a816-a281bf8f0c10","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：クローズ対象アプリケーションをリスト化"}}]},{"uid":"ecb3bb5a-a491-4cd7-ae32-6100aa0370f8","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strCloseApp$"}},{"name":"delimiter","value":{"type":"STRING","string":","}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"lCloseApp"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"クローズ対象リスト作成"}}]},{"uid":"c2faf793-128d-4a88-8e07-fa144a577b21","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"594097e7-4980-4ffc-91dd-79eb9061b1ac","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"317b5568-c797-4003-abd6-77a9c205ae69","commandName":"runApp","packageName":"Application","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://taskkill"}},{"name":"startInPath","value":{"type":"STRING","string":""}},{"name":"parameters","value":{"type":"STRING","expression":"/f /im $strSetApp$"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"strSetApp"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"lCloseApp"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"アプリケーションクローズ"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"処理 A(開発者設定)"}}]},{"uid":"ce8802da-9c0c-48e6-9711-651b4154521b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：終了ログ取得"}}]},{"uid":"63b54dba-8fa5-4d81-800d-418764364128","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,$strSyoriTitle$処理終了,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"a92e7c95-ff9a-4f89-8c17-6777c9b17126","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"f1f5662e-efae-4464-9834-1cd4bc481c7e","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$numErrorNum$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"strErrorNum"}},{"uid":"16f22140-641f-4eb8-a73d-a6cee5d0e7ef","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strErrorNum$ > $strErrorMsg$,$strTaskName$"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorMsg"}},{"uid":"9ea641ea-43ed-49e6-b440-25136eaa994c","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","expression":"$strSystemErrorMsg$"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"strErrorMsg"},"errorLineNumber":{"type":"VARIABLE","variableName":"numErrorNum"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"strTaskName","description":"タスク名","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"Common_9999_CommonTask_Master0001"}},{"name":"strSyoriTitle","description":"タスク処理概要","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"子Bot標準"}},{"name":"strInfoLog","description":"ログメッセージ編集固定文(Info)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strLogFilePath","description":"ログファイルフルパス","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strCloseApp","description":"クローズするアプリケーションをカンマ区切りで取得","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"lCloseApp","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"strSetApp","description":"クローズするアプリケーション","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strBlock","description":"タスク名置換用","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"$3"}},{"name":"strErrorMsg","description":"システムエラーメッセージ","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"numErrorNum","description":"システムエラー番号","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"strErrorNum","description":"システムエラー番号","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strSystemErrorMsg","description":"システムエラーメッセージ編集","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"If","version":"2.0.0-20200515-071441"},{"name":"Step","version":"2.0.0-20200417-230833"},{"name":"TaskBot","version":"2.0.0-20200519-082744"},{"name":"Application","version":"2.0.0-20200515-071407"},{"name":"ErrorHandler","version":"2.0.0-20200515-071432"},{"name":"Comment","version":"2.0.0-20200418-005342"},{"name":"System","version":"2.0.0-20200515-071729"},{"name":"LogToFile","version":"2.0.0-20200418-005423"},{"name":"List","version":"2.0.0-20200515-071509"},{"name":"Loop","version":"2.0.0-20200515-071511"},{"name":"Number","version":"2.0.0-20200515-071522"},{"name":"String","version":"3.0.0-20200418-005635"}],"workItemTemplateName":null}