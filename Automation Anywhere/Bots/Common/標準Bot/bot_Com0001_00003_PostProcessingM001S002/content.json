{"triggers":[],"nodes":[{"uid":"a37e06ca-b408-45de-b963-a64159f660ff","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4635a6f0-c970-46a9-bea2-f6e55c1e165c","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f3b0d0c9-468e-4c1c-a3dd-5c19bbeca556","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：処理プロセス名(ログファイルで表示)"}}]},{"uid":"6c8e2400-fd20-4700-aaca-3b0d71abb7ee","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"後"}}],"returnTo":{"type":"VARIABLE","variableName":"strSyoriTitle"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"初期設定(開発者設定)※共通のため編集不可"}}]},{"uid":"a57fcc9c-ba54-4c94-b3aa-69518ab399fc","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f2c12a34-78a0-4250-ac5c-fd36348623a1","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：子Bot(Sub Task)"}}]},{"uid":"09e363b6-5fd9-488c-ae1a-cf70decdb368","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"name":"find","value":{"type":"STRING","string":"^/(.+/)*(.+)/(.+)"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$strBlock$"}}],"returnTo":{"type":"VARIABLE","variableName":"strTaskName"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"初期設定(固定値)"}}]},{"uid":"967f09d3-d100-4654-b652-6b05872c93a2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：開始ログ取得"}}]},{"uid":"2feea4a6-7776-4676-9859-a3dc4ab70466","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,$strSyoriTitle$処理開始,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"69a6b0ce-311f-43bc-83c3-ce5ab2cef505","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"8705b287-7ba5-408a-bff7-322207e56668","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"2cc3ed7d-b744-453a-951d-b2d63619840f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"14343bf7-10b4-4531-8491-6c1fcff01e37","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strSystemErrorMsg$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"daf68b17-8371-4697-8528-dfa01b597e2c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"1e112fa4-131c-444a-8cdb-733a38f225da","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,システムエラーファイル取得開始,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"69ad1a33-ed3e-40b5-8e4a-58da45760289","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"356243f5-d5c0-4baa-b93d-58cc073154b9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーメッセージファイル/システムエラー画面キャプチャファイル名の日時取得"}}]},{"uid":"07540b0a-603e-4e1a-99cf-6184e5805f09","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","expression":"$strDateFormat$"}}],"returnTo":{"type":"VARIABLE","variableName":"strDate"}},{"uid":"fbd7b94f-d3bd-48f2-b3bf-4c3772d55f5c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーメッセージファイル作成"}}]},{"uid":"9e120391-d43b-47fe-99e9-f696c2fa64fd","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strSystemErrorFilePath$/【Error】$strMasterTaskName$_$strDate$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":",$strSystemErrorMsg$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"d643b488-2751-40b0-8f9b-f6c265ddcb99","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラー画面キャプチャ作成"}}]},{"uid":"0dd4ec7d-f480-4794-bed7-224c606a6b6b","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strErrorImageFilePath$/【Error】$strMasterTaskName$_$strDate$.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"システムエラーメッセージファイル作成/システムエラー画面キャプチャ取得"}}]},{"uid":"4db602b2-abbb-4787-b638-196e76d225e8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"4ade7ca0-e050-4888-9df5-941d6e6e5545","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,システムエラーファイル取得終了,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strSystemErrorMsg$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"システムエラー発生時実行"}}]},{"uid":"a665447a-d533-4048-b433-eaf004c6d50b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"8dd2dccc-b345-4ea0-b319-a28aa3a7a9e6","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,システムエラーファイルBoxにアップロード開始,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"06e59cf6-e0af-452e-aad7-7b1602c2b7b8","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"29703048-6b53-4cd5-a45e-0708d03b395d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：過去取得したシステムエラーメッセージファイルがBoxへアップロードされなかったファイルもBoxへアップロードする"}}]},{"uid":"8e71b61e-6052-4de6-80dd-08728500bffc","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーメッセージファイルのフルパスを取得"}}]},{"uid":"eaeb8ebb-d02c-4bd4-9e87-0150c9fe329e","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"0bcd5c9a-30b9-44c4-ac78-eb04cd83d318","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーメッセージファイルフルパス取得"}}]},{"uid":"a0f6952e-c6a3-46fe-85f6-5081e2d69558","commandName":"get","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dErrorLogFileCopy"}},{"name":"key","value":{"type":"STRING","string":"name"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorFileName"}},{"uid":"85192f31-91ba-4915-8ef0-6defec7080a8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strSystemErrorFilePath$\\$strSystemErrorFileName$."}}],"returnTo":{"type":"VARIABLE","variableName":"strPath"}},{"uid":"956ce03c-e746-4e33-8bdd-782408f40b4f","commandName":"get","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dErrorLogFileCopy"}},{"name":"key","value":{"type":"STRING","string":"extension"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorFileName"}},{"uid":"d49571f3-d1af-4794-a2b4-d05a137a51d3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strPath$$strSystemErrorFileName$"}}],"returnTo":{"type":"VARIABLE","variableName":"strPath"}},{"uid":"be0269d4-a171-4643-810a-33921c13e647","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：メール送信用添付ファイルリスト作成"}}]},{"uid":"f106b210-025f-43f2-8b51-29ccf2efc7f8","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"9b0ec5b8-b91b-4c80-bc6c-5e4864f30772","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strSystemErrorFilePathList$;"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorFilePathList"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strSystemErrorFilePathList$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"31e4e886-e071-4aff-ae71-7352bcc3a0dc","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strSystemErrorFilePathList$$strPath$"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorFilePathList"}},{"uid":"3c40ba64-791e-4101-87ba-163c29a67e2e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーメッセージファイルコピー"}}]},{"uid":"34e4ef6b-e695-489e-a00f-b774cf959f6b","commandName":"copyFiles","packageName":"File","disabled":true,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$strPath$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$strSystemErrorPubFilePath$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"ac262813-db17-4894-bcca-3bb73df1ea5f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"strPath"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"dErrorLogFileCopy"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strSystemErrorFilePath$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]},{"uid":"9090b916-1770-4af0-9bb1-8863c529ceb2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラー画面キャプチャのフルパスを取得"}}]},{"uid":"648a96c6-75d6-47c6-bb7d-7a7850c74e42","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"4c45b7ba-2a35-41b9-9707-c05c09fe8c66","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラー画面キャプチャフルパス取得"}}]},{"uid":"3f9488c8-9516-4991-917d-c9976b86df30","commandName":"get","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dErrorImageFileCopy"}},{"name":"key","value":{"type":"STRING","string":"name"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorFileName"}},{"uid":"de25fb79-4d45-4af3-9240-5378d4248ac6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strErrorImageFilePath$\\$strSystemErrorFileName$."}}],"returnTo":{"type":"VARIABLE","variableName":"strPath"}},{"uid":"6e672d94-ff11-40c6-9b35-843a77fe99d6","commandName":"get","packageName":"Dictionary","disabled":false,"attributes":[{"name":"sourceMap","value":{"type":"VARIABLE","variableName":"dErrorImageFileCopy"}},{"name":"key","value":{"type":"STRING","string":"extension"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorFileName"}},{"uid":"ffb0ddcb-043d-4be9-ac24-582e1e08b86b","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strPath$$strSystemErrorFileName$"}}],"returnTo":{"type":"VARIABLE","variableName":"strPath"}},{"uid":"2bf3fbfe-31bb-4ed9-9b33-0a3bb75f89c5","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：メール送信用添付ファイルリスト作成"}}]},{"uid":"9254ec6a-eb55-40ec-85bb-25db033cdf9a","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"7786a67d-470d-4837-b1b9-50536e83f7b2","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strSystemErrorFilePathList$;"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorFilePathList"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strSystemErrorFilePathList$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"e8f83fc7-0180-4c63-9aa7-9c64ada67c8f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strSystemErrorFilePathList$$strPath$"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorFilePathList"}},{"uid":"2a4b3e9e-5b45-4101-af52-c120a1e2558f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラー画面キャプチャコピー"}}]},{"uid":"79e5c6c4-6ff9-4b45-bd69-a7e3e5b0774c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"strPath"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"dErrorImageFileCopy"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strErrorImageFilePath$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Boxにシステムエラーメッセージ画面/システムエラー画面キャプチャを保存"}}]},{"uid":"5c8a8d9f-f9bd-43b5-9194-de57980d8649","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"4467155a-111d-4cab-a09b-4f1863b0e2a8","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"b6a77360-176d-40d2-8e1b-677cbdb17644","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"b9d3f24f-749d-41f2-bbe1-88765d434175","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,Boxへアップロードするシステムエラーファイルがありません,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"30db7b85-2162-4f5d-a690-85f342000eaf","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"strBoxSystemErrorMsg"}}],"branches":[{"uid":"1d590ffb-7558-4833-b81c-2b8eedade049","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"2cf655b1-c7e2-43ca-a5d7-2b4e64fd3612","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Boxへ保存するファイルのフルパス(strSystemErrprFilePathListに全てのファイルが「;」区切りで追加されている)"}}]},{"uid":"b6ce7861-d0cd-4d88-85b4-11833fc71e74","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Box保存Botを呼び出す"}}]},{"uid":"df8be28c-cae6-42e7-ad42-cb554d0649c0","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"22058520-0bee-48ad-87f2-e8d369473256","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"strInfoLog","value":{"type":"STRING","expression":"$strInfoLog$"}},{"key":"strErrorLog","value":{"type":"STRING","expression":"$strErrorLog$"}},{"key":"strSystemErrorMsg","value":{"type":"STRING","expression":"$strSystemErrorMsg$"}},{"key":"strLogFilePath","value":{"type":"STRING","expression":"$strLogFilePath$"}},{"key":"strBoxPath","value":{"type":"STRING","expression":"$strBoxPath$"}},{"key":"strFilePath","value":{"type":"STRING","expression":"$strSystemErrorFilePathList$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Common/標準Bot/Com0001_00006_UploadToBoxM001S005"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"dResult"}}],"branches":[{"uid":"5ea18be1-c4ad-4218-ab83-373c9f1337b7","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"1ecf0e80-9977-4b5a-b0b4-6243c35b41e2","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーメッセージ取得"}}]},{"uid":"f69622b7-3dae-4620-bc97-70dca3fa4a75","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strBoxSystemErrorMsg$"}}],"returnTo":{"type":"VARIABLE","variableName":"strBoxSystemErrorMsg"}},{"uid":"a8526597-ff65-4dfc-a537-de7f1386a648","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strBoxSystemErrorMsg$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"strBoxSystemErrorMsg"},"errorLineNumber":{"type":"VARIABLE","variableName":"numBoxErrorNum"}}}]},{"uid":"c8024881-37e5-4a5c-96c8-2cb4c8bb8c44","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"0d728a94-228d-428d-9fc3-cf16c30b3bf3","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"6c64fa2d-ea8f-49ee-8d99-798eb77a86ad","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Box保存成功"}}]},{"uid":"bf3e3e87-8ad5-4001-97b8-519125d9e5e2","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,Boxアップロード成功,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"3dd40b13-05dc-460e-b652-2845eadec615","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"7c0b99a6-e8ee-4930-8399-4dd6ea880d79","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Box保存失敗"}}]},{"uid":"968c8571-5108-42db-98e1-da8731763164","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,Boxアップロード失敗,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"1af45eb7-ee08-464a-886b-33f274938e2b","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"5f5d163e-638f-4658-ab34-9f7fbdb269b1","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Boxドライブ経由で保存する"}}]},{"uid":"b5af330e-691c-4e79-98a4-ef108064b022","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,Boxドライブでファイル保存開始,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"7929a6d9-8647-486c-8248-070754f0d92d","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"f78a2178-f8da-4fd2-a21a-a7d3da366691","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[{"key":"strInfoLog","value":{"type":"STRING","expression":"$strInfoLog$"}},{"key":"strErrorLog","value":{"type":"STRING","expression":"$strErrorLog$"}},{"key":"strSystemErrorMsg","value":{"type":"STRING","expression":"$strSystemErrorMsg$"}},{"key":"strLogFilePath","value":{"type":"STRING","expression":"$strLogFilePath$"}},{"key":"strBoxUploadFileList","value":{"type":"STRING","expression":"$strSystemErrorFilePathList$"}},{"key":"strBoxPath","value":{"type":"STRING","expression":"$strBoxPath$"}}]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/Common/標準Bot/Com0001_00007_BoxDriveUploadM001S006"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}],"returnTo":{"type":"VARIABLE","variableName":"dResult"}}],"branches":[{"uid":"1b810771-1784-459d-b025-6c50d7089363","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"b44721d6-608f-4821-812c-b3a58e72632a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーメッセージ取得"}}]},{"uid":"5a0b36ca-590d-43d3-978a-da999688d334","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strBoxDSystemErrorMsg$"}}],"returnTo":{"type":"VARIABLE","variableName":"strBoxDSystemErrorMsg"}},{"uid":"f0faba25-9fc4-4077-b2bc-9b1a930b663a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strBoxDSystemErrorMsg$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"strBoxDSystemErrorMsg"},"errorLineNumber":{"type":"VARIABLE","variableName":"numBoxDErrorNum"}}}]},{"uid":"562b0dd1-a238-4881-8b30-02d272582ea3","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"d7628a24-d4e1-463d-9778-79a725e1ad08","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Boxドライブ経由保存成功"}}]},{"uid":"812ad731-c023-48ad-9d62-04ebae4405a0","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,Boxドライブアップロード成功,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"cfcf9b89-3c72-4dcb-9787-92ef330b5bde","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Boxアップロードができたため、FTPにて発生したBox保存失敗エラーメッセージを削除"}}]},{"uid":"907b30e0-877a-410e-84b9-e70c8db262d1","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"strBoxSystemErrorMsg"}}],"branches":[{"uid":"1a35e769-cb60-435a-81fe-16c26fc3dd74","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"4cb4079d-495a-452e-b46c-02f87e889f8c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Boxドライブ経由保存失敗"}}]},{"uid":"f30cb2fc-8275-4028-923b-414a285e17b0","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,Boxドライブアップロード失敗,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"832a5f6c-19c7-41e5-be29-5c5f22adbe31","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Boxファイルアップロード時システムエラーメッセージ結合"}}]},{"uid":"75591296-742e-40b1-9326-5f904bf63b50","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strBoxSystemErrorMsg$/$strBoxDSystemErrorMsg$"}}],"returnTo":{"type":"VARIABLE","variableName":"strBoxSystemErrorMsg"}}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strBoxDSystemErrorMsg$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"1f76cf1c-f0ab-4880-9404-bd2790023a87","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Boxドライブ経由で保存する"}}]},{"uid":"3c5d39ec-8e5a-407f-a560-7adc0e7f905f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,Boxドライブでファイル保存終了,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Boxドライブを使用してアップロード(9/4追加)"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strBoxSystemErrorMsg$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strSystemErrorFilePathList$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"FTPを使用してBoxへアップロード"}}]},{"uid":"8bee838c-92cd-4e86-bdfa-f3325d25274d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"56190ff6-c58d-4d9e-b4db-d005d063eaa8","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,システムエラーファイルBoxにアップロード終了,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"54261381-e114-433c-94ec-ff1f812d163d","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f61399e3-3400-4cac-a331-4d0460bc6313","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Box保存成功 / Box保存なしの場合"}}]},{"uid":"ed81327b-c642-4dd0-8c97-4e973581051f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"f99e8b50-595e-488d-96c5-2be29fc96560","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"1f46136b-f6b5-4ab9-9a3d-a15e742de7af","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,システムエラーフォルダ削除開始,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"a98602b7-a78e-4218-89d1-cd4c0f3ac71a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーメッセージファイルRunnerから削除"}}]},{"uid":"663d9320-1a76-4489-81f5-3756bae48701","commandName":"deleteFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strSystemErrorFilePath$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"29d3c457-f6bb-4faa-8bc1-6c4628b5762c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"1023938d-bb32-47db-8208-28128da34530","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,「$strSystemErrorFilePath$」フォルダを削除しました,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"07a2bf06-3e9c-4c26-a749-7570dd10a17c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラー画面キャプチャRunnerから削除"}}]},{"uid":"a144c0a4-3837-4cdd-9335-5cb9e5cbebef","commandName":"deleteFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strErrorImageFilePath$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"4555e4c9-0eba-427f-ac04-82ec591ace8c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"a1250db4-45ad-45b5-a082-5f2a55793ddf","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,「$strErrorImageFilePath$」フォルダを削除しました,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"ab1941da-5319-427a-bfcb-4147ebd6cf1d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"f1af32a1-2051-4c21-bf48-d42de00601c3","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,システムエラーフォルダ削除終了,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strBoxSystemErrorMsg$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Runnerからシステムエラーメッセージファイルフォルダ/システムエラー画面キャプチャフォルダ削除"}}]},{"uid":"2f0cd527-4681-4280-b56d-348889184e06","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"a90bb703-f034-4c95-8d43-72012b8f4f5b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：メールフォーマットパスが存在する場合のみメールを送信"}}]},{"uid":"0c0bfd78-ce05-4cc6-8e00-5e077c2c4456","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"73d707ce-53c3-436e-a089-f663e4f54609","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"9bef14ab-26f3-4dbf-aa40-2c939446ebe8","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,メール送信処理開始,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"88d388a4-c522-41e9-8ae5-075ea50f6ede","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Outlook開く"}}]},{"uid":"bbac8981-3fc5-438d-ba35-69e465573554","commandName":"runApp","packageName":"Application","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file:///C:/Program%20Files%20%28x86%29/Microsoft%20Office/root/Office16/OUTLOOK.EXE"}},{"name":"startInPath","value":{"type":"STRING","string":""}},{"name":"parameters","value":{"type":"STRING","string":""}}]},{"uid":"a3536113-da94-4c2f-a6f1-af5ed7c971de","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"10"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]},{"uid":"9ddf162a-ba4b-4b95-942e-ecc55df2b524","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：送信対象メールフォーマット判定"}}]},{"uid":"4fe007e2-124b-4f0b-8d5f-1d3a58c5b2fa","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"b4569505-39d8-472c-9248-215e2d7ad52e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーがある場合/処理失敗(Faild)"}}]},{"uid":"fdc4fa40-1305-4ba4-a908-87cddb055694","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：メールフォーマット開く(失敗)"}}]},{"uid":"4e0af26a-b17f-4524-a04b-b7088b53411a","commandName":"openFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strMailFormatPathFailed$"}}]}],"branches":[{"uid":"7e5727ab-0f1e-4f98-94aa-4324b28de95f","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"80a28d18-0d0d-4e31-bc03-67d8f4895e9b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーがない場合/処理成功(Success)"}}]},{"uid":"288f866a-59de-480f-ac79-1723dbb42c7c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：メールフォーマット開く(成功)"}}]},{"uid":"58e8cc23-bb83-4ace-9ede-a92da599090e","commandName":"openFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strMailFormatPathSuccess$"}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strSystemErrorMsg$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"2f79d248-fb71-4940-a27c-a6afe7c4f5ce","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"9aadb795-29cb-4411-9b99-7947e59ca24d","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"10"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]},{"uid":"9671890f-c355-470b-8f5a-282f916f3a3c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：メールフォーマットアクティブウィンドウ&最大化"}}]},{"uid":"27e0f24e-5076-4d40-868d-0250b0cd1ba4","commandName":"activateWindow","packageName":"Window","disabled":false,"attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-1$"}}]},{"uid":"ab988946-c1dc-4879-b664-6ee5228e57d8","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"3"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]},{"uid":"7e3cc94d-8cdd-4562-a616-66114ae5f9ba","commandName":"maximizeWindow","packageName":"Window","disabled":false,"attributes":[{"name":"window","value":{"type":"WINDOW","expression":"$window-1$"}}]},{"uid":"41ccd30f-5aa2-42ec-a7e0-ce97163c4f5e","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"5"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]},{"uid":"bb78477b-8480-402d-8af6-ffca28e692ce","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：メール送信"}}]},{"uid":"932e6fd8-10c9-48ad-9792-27bad65d7d7e","commandName":"Keystrokes","packageName":"Keystrokes","disabled":false,"attributes":[{"name":"windowValue","value":{"type":"WINDOW","expression":"$window-1$"}},{"name":"typeOfInputStringToType","value":{"type":"STRING","string":"VALUE"}},{"name":"stringToType","value":{"type":"STRING","string":"[ALT DOWN]s[ALT UP]"}},{"name":"delay","value":{"type":"NUMBER","number":"3"}}]},{"uid":"6317a586-d5c1-4daf-b987-fc094f889278","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"10"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]},{"uid":"a5bf307c-d808-43bc-8674-109286409993","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"1b458df5-20d5-4f39-a0da-87e20a077b14","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,メール送信成功,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"ebd042dc-46b3-4e3d-bc24-1d614c3d539b","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"ab60f7d5-2e42-4b15-920d-5a409c4ac341","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$numMailErrorNum$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"strMailErrorNum"}},{"uid":"04cca6b6-cc67-4b4c-8d14-b337ac6fbcd2","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strMailErrorNum$ > $strMailErrorMsg$,$strTaskName$"}}],"returnTo":{"type":"VARIABLE","variableName":"strMailSystemErrorMsg"}},{"uid":"937fabe4-285c-4668-8e15-8b325138e775","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"5ab914e9-1294-4d22-9037-59a26c4e48ec","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,$strMailSystemErrorMsg$,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"strMailErrorMsg"},"errorLineNumber":{"type":"VARIABLE","variableName":"numMailErrorNum"}}}]},{"uid":"c591df8c-0d4b-4310-9b97-6dd1be68e15f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"2047d808-ce20-4bc5-86c8-703520949a3a","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,メール送信処理終了,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"092e1049-ca34-4e0c-b7f9-5e6f9b19a8b8","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"11f50ddb-ea05-465a-b5cc-ec7abfe44a95","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：メールフォーマットフォルダ存在チェック"}}]},{"uid":"f582db8c-0854-4255-b407-90dcf243414b","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"1dd1b2f6-4d75-44ac-882d-cbef081fa464","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：フォルダ削除"}}]},{"uid":"52e1daff-76e6-41b4-ae04-f363df0c3838","commandName":"deleteFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strMailFormatPath$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"105564ee-2fc0-45c7-9742-8adba0cfa406","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"edf9bbb3-b972-42a6-87f8-5ffda83595cf","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,「$strMailFormatPath$」フォルダを削除しました,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$strMailFormatPath$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderExists","packageName":"Folder"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"メールフォーマットファイルフォルダ削除"}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$strMailFormatPathSuccess$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"},"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$strMailFormatPathFailed$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"fileExists","packageName":"File"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"メール送信(9/25修正)"}}]},{"uid":"aa07c5c9-f979-4ae6-a23e-f6d941113e86","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：終了ログ取得"}}]},{"uid":"77119dbb-212a-4305-be34-2d440774a6c9","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,$strSyoriTitle$処理終了,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"8c312fa4-aaa4-4546-9308-c182e2d9f3a3","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"ba1d6786-2fe2-490f-a608-c2a5bf648cdc","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$numErrorNum$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"strErrorNum"}},{"uid":"11fc7d8e-4733-496a-b402-71e8eec96046","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strErrorNum$ > $strErrorMsg$,$strTaskName$"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorMsg"}},{"uid":"4b62984e-890e-4adf-86b6-3841c5737d33","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","expression":"$strSystemErrorMsg$"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"strErrorMsg"},"errorLineNumber":{"type":"VARIABLE","variableName":"numErrorNum"}}},{"uid":"0f51ee20-1062-4566-82d2-2f3aa77f96c2","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"bed72bf3-883f-4179-856c-f9aaa40e8cd4","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"895d9162-0877-4189-893f-415cf68cc9c2","commandName":"runApp","packageName":"Application","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","string":"file://taskkill"}},{"name":"startInPath","value":{"type":"STRING","string":""}},{"name":"parameters","value":{"type":"STRING","string":"/f /im OUTLOOK.EXE"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"OutlookアプリケーションKill"}}]}]}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"strTaskName","description":"タスク名","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"Com0001_0003_SendMailM0001"}},{"name":"strSyoriTitle","description":"タスク処理概要","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"処理結果メール送信"}},{"name":"strInfoLog","description":"ログメッセージ編集固定文(Info)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strErrorLog","description":"ログメッセージ編集固定文(Error)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strDateFormat","description":"システムエラー画面ファイル名日付部分フォーマット","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strSystemErrorMsg","description":"システムエラーメッセージ編集","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"strErrorImageFilePath","description":"システムエラー画面ファイル名パスの一部(フォルダ\\親Bot(Master Task)\\001_Image\\親Bot(Master Task))","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strLogFilePath","description":"ログファイルフルパス","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strErrorMsg","description":"システムエラーメッセージ","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"numErrorNum","description":"システムエラー番号(システムエラーが発生したBot内の行数)","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"strErrorNum","description":"システムエラー番号(システムエラーが発生したBot内の行数)を文字列に変換","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strDate","description":"日付編集","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strMailContent","description":"処理結果メール本文","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strSystemErrorFilePath","description":"システムエラーメッセージファイルフルパス","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strMasterTaskName","description":"親Bot(Master Task)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strSystemErrorPubFilePath","description":"システムエラーメッセージファイル及びシステムエラー画面キャプチャ共有サーバ格納先","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dErrorLogFileCopy","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"strSystemErrorFileName","description":"システムエラーメッセージファイル名","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strPath","description":"ファイルパス一時格納","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strSystemErrorFilePathList","description":"メール送信添付ファイルリスト作成","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dErrorImageFileCopy","description":"システムエラー画面キャプチャ共有サーバコピー","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"strCloseApp","description":"クローズ対象アプリケーション","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"dResult","description":"タスク実行戻り値","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"strBlock","description":"タスク名置換用","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"$3"}},{"name":"strBoxPath","description":"Box保存先パス","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strBoxSystemErrorMsg","description":"Box保存システムエラーメッセージ","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"numBoxErrorNum","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"strBoxDSystemErrorMsg","description":"Boxドライブファイルアップロードシステムエラーメッセージ","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"numBoxDErrorNum","description":"Boxドライブファイルアップロードシステムエラー番号(ライン数)","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"strMailFormatPathSuccess","description":"メールフォーマットファイル保存先パス(成功)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strMailFormatPathFailed","description":"メールフォーマットファイル保存先パス(失敗)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"window-1","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"* - メッセージ (HTML 形式) ","path":"C:\\Program Files (x86)\\Microsoft Office\\root\\Office16\\OUTLOOK.EXE","class":"rctrl_renwnd32","handle":"5508676","isChild":false,"location":{"top":134,"left":96},"size":{"height":841,"width":1237},"presetType":"NONE"}}},{"name":"strMailErrorMsg","description":"メール送信システムエラーメッセージ","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"numMailErrorNum","description":"メール送信システムエラーメッセージ番号","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"strMailErrorNum","description":"メール送信システムエラーメッセージ番号文字列変換","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strMailSystemErrorMsg","description":"メール送信システムエラーメッセージ編集","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strMailFormatPath","description":"メールフォーマットファイル保存先パス(基準)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"If","version":"2.0.0-20200418-005406"},{"name":"Step","version":"2.0.0-20200417-230833"},{"name":"Application","version":"2.0.0-20200624-041608"},{"name":"Window","version":"2.1.0-20200813-181240"},{"name":"ErrorHandler","version":"2.0.0-20200515-071432"},{"name":"Keystrokes","version":"2.1.0-20200721-222204"},{"name":"Comment","version":"2.0.0-20200418-005342"},{"name":"System","version":"2.0.0-20200418-005636"},{"name":"Screen","version":"2.0.0-20200418-005625"},{"name":"TaskBot","version":"2.0.0-20200624-103759"},{"name":"Dictionary","version":"2.0.0-20200418-005349"},{"name":"File","version":"2.1.0-20200515-071434"},{"name":"LogToFile","version":"2.0.0-20200418-005423"},{"name":"Folder","version":"2.1.0-20200515-071436"},{"name":"Loop","version":"2.0.0-20200515-071511"},{"name":"Number","version":"2.0.0-20200515-071522"},{"name":"String","version":"3.0.0-20200418-005635"},{"name":"Datetime","version":"2.0.0-20200418-005348"},{"name":"Delay","version":"2.1.0-20200721-221959"}],"workItemTemplateName":null}