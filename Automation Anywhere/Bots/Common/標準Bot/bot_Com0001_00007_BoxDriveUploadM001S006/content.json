{"triggers":[],"nodes":[{"uid":"7d735702-fd07-4822-953b-a929327257f8","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"8a994c49-6d00-473d-8c89-d465cc4bf29a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"ecec2867-8896-4f00-a412-4bedb393c721","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：処理プロセス名(ログファイルで表示)"}}]},{"uid":"0987328c-cc6b-4f21-940e-950dacbc6aa6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Boxドライブファイルアップロード"}}],"returnTo":{"type":"VARIABLE","variableName":"strSyoriTitle"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"初期設定(開発者設定)"}}]},{"uid":"ca1b7cdb-889c-4c04-aa05-e9a8b101461a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"d6623988-20e7-446f-a0b6-cb6e43c1ae68","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：子Bot(Sub Task)"}}]},{"uid":"960f38bf-9d55-4ac6-84a4-6f88b97f7bef","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"name":"find","value":{"type":"STRING","string":"^/(.+/)*(.+)/(.+)"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$strBlock$"}}],"returnTo":{"type":"VARIABLE","variableName":"strTaskName"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"初期設定(固定値)"}}]},{"uid":"750d4c06-0a1d-42ea-a88b-32c0471b6efe","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：開始ログ取得"}}]},{"uid":"e64f78c2-3b9d-43c9-b4c6-36823e9377a2","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,$strSyoriTitle$処理開始,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"010c97ad-0e32-432b-88c6-5d85d8ef9e00","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"584ba1ae-5193-4f04-895a-17e6049abdcc","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ファイルをリスト変数格納"}}]},{"uid":"0b7b7aaf-f1eb-43d0-934d-fca3d28878bf","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strBoxUploadFileList$"}},{"name":"delimiter","value":{"type":"STRING","string":";"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"lBoxUploadFileList"}},{"uid":"e4d9845b-7007-429e-81aa-3512528372b5","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Boxドライブを使用してアップロード"}}]},{"uid":"67d60de5-a371-437f-ae81-eeea0f6bcd31","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strBoxPath$"}},{"name":"find","value":{"type":"STRING","string":"/"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":"\\"}}],"returnTo":{"type":"VARIABLE","variableName":"strBoxDrivePath"}},{"uid":"94c5967e-95a5-4581-8587-5036d26a3001","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"327a1465-6600-4445-a349-6106a4456672","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ファイル名のみ取得"}}]},{"uid":"982e2e82-317c-4ec3-8813-dacba2d925a5","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strUploadFile$"}},{"name":"delimiter","value":{"type":"STRING","string":"\\"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"lUploadFileName"}},{"uid":"b9f50cae-e72f-4769-8c86-501a8f87c80b","commandName":"listSize","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lUploadFileName"}}],"returnTo":{"type":"VARIABLE","variableName":"numUploadName"}},{"uid":"d4480f3e-f423-4a26-b8e0-448db4b8de38","commandName":"decrement","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$numUploadName$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"numUploadName"}},{"uid":"dd5ea2cc-1ec2-459d-ad81-adeeaf5fa611","commandName":"get","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lUploadFileName"}},{"name":"itemPositionNumber","value":{"type":"NUMBER","expression":"$numUploadName$"}}],"returnTo":{"type":"VARIABLE","variableName":"strUploadFileName"}},{"uid":"2c2aeb43-2481-44a1-8f6a-fe1127a76fd3","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$strUploadFile$　：　$@strGUserProfile$\\Box\\$strBoxPath$\\$strUploadFileName$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"249f8c20-2972-4fce-a65a-f8bd451ca53b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Boxドライブ経由ファイルコピー"}}]},{"uid":"ca308dd2-ff14-444b-bb4e-0d2aeff6c548","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$strUploadFile$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$@strGUserProfile$\\Box\\$strBoxDrivePath$\\$strUploadFileName$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"a17b6e90-dfd3-45ba-90c6-45145ee80883","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"1"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]},{"uid":"2a60cc99-964e-4e35-b75b-f3fe37e73091","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：終了ログ取得"}}]},{"uid":"420284f2-5f74-4122-8839-cf527fcdf083","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,「/$strBoxPath$」に「$strUploadFile$」をアップロードしました,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"9d578995-c4cd-41d3-b9ee-d796cabc234f","commandName":"Comment","packageName":"Comment","disabled":true,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ファイル存在チェック"}}]},{"uid":"e48e828c-d5c0-4a04-bcb2-9426816529a7","commandName":"if","packageName":"If","disabled":true,"children":[],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$@strGUserProfile$/Box/$strBoxPath$/$strUploadFileName$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"fileNotExists","packageName":"File"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"strUploadFile"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"lBoxUploadFileList"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Boxドライブを使用してアップロード"}}]},{"uid":"50e85a93-dc7b-4435-bed0-3ce3aeb58e2b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：終了ログ取得"}}]},{"uid":"69a79c6a-1166-4c23-a168-96b3c54d509f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,$strSyoriTitle$処理終了,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"ffb3cb13-c1c1-4564-a720-4089ac01706f","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"5c5b8256-7c92-4e05-b462-41e8d76ca5ae","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーメッセージ編集"}}]},{"uid":"1a4cb2b7-c14f-4d4e-82e9-54a7d15d78af","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$numErrorNum$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"strErrorNum"}},{"uid":"7e2c34dc-8085-49b4-9ef0-7ae5077accf2","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strErrorLog$,$strErrorNum$ > $strErrorMsg$,$strTaskName$"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorMsg"}},{"uid":"f40f84b4-485e-4350-8fbf-90b37545b785","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$strErrorLog$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f705ad65-b9cb-4478-856e-49ce6a14d2bc","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","expression":"$strSystemErrorMsg$"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"strErrorMsg"},"errorLineNumber":{"type":"VARIABLE","variableName":"numErrorNum"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"strTaskName","description":"タスク名","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"Common_9999_CommonTask_Master0001"}},{"name":"strSyoriTitle","description":"タスク処理概要","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"子Bot標準"}},{"name":"strInfoLog","description":"ログメッセージ編集固定文(Info)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strErrorLog","description":"ログメッセージ編集固定文(Error)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strSystemErrorMsg","description":"システムエラーメッセージ編集","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"strLogFilePath","description":"ログファイルフルパス","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strErrorMsg","description":"システムエラーメッセージ","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"numErrorNum","description":"システムエラー番号(システムエラーが発生したBot内の行数)","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"strErrorNum","description":"システムエラー番号(システムエラーが発生したBot内の行数)を文字列に変換","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strBlock","description":"タスク名置換用","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"$3"}},{"name":"lBoxUploadFileList","description":"Boxドライブファイルアップロード対象ファイル(フルパス)をリスト変数に設定","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"strBoxUploadFileList","description":"Boxドライブファイルアップロード対象ファイル(フルパス)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strUploadFile","description":"Boxドライブアップロード対象ファイル(フルパス)","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strUploadFileName","description":"Boxドライブファイルアップロードファイル名(ファイル名のみ)","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"lUploadFileName","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"numUploadName","description":"Boxドライブファイルアップロード対象パスを[\\」で区切る","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"strBoxPath","description":"Boxドライブ格納先パス(一部)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strBoxDrivePath","description":"Boxドライブファイルアップロード用の置換","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"If","version":"2.0.0-20200721-222021"},{"name":"Step","version":"2.0.0-20200417-230833"},{"name":"ErrorHandler","version":"2.0.0-20200418-005357"},{"name":"Comment","version":"2.0.0-20200418-005342"},{"name":"System","version":"2.0.0-20200515-071729"},{"name":"File","version":"2.1.0-20200721-222011"},{"name":"LogToFile","version":"2.0.0-20200418-005423"},{"name":"MessageBox","version":"2.0.0-20200721-222213"},{"name":"List","version":"2.0.0-20200721-222211"},{"name":"Loop","version":"2.0.0-20200721-222213"},{"name":"Number","version":"2.0.0-20200418-005433"},{"name":"String","version":"3.0.0-20200418-005635"},{"name":"Delay","version":"2.1.0-20200721-221959"}],"workItemTemplateName":null}