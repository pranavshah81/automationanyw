{"triggers":[],"nodes":[{"uid":"7d735702-fd07-4822-953b-a929327257f8","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"8a994c49-6d00-473d-8c89-d465cc4bf29a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"ecec2867-8896-4f00-a412-4bedb393c721","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：処理プロセス名(ログファイルで表示)"}}]},{"uid":"0987328c-cc6b-4f21-940e-950dacbc6aa6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Boxアップロード"}}],"returnTo":{"type":"VARIABLE","variableName":"strSyoriTitle"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"初期設定(開発者設定)"}}]},{"uid":"ca1b7cdb-889c-4c04-aa05-e9a8b101461a","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"d6623988-20e7-446f-a0b6-cb6e43c1ae68","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：子Bot(Sub Task)"}}]},{"uid":"960f38bf-9d55-4ac6-84a4-6f88b97f7bef","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$System:AATaskName$"}},{"name":"find","value":{"type":"STRING","string":"^/(.+/)*(.+)/(.+)"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"true"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$strBlock$"}}],"returnTo":{"type":"VARIABLE","variableName":"strTaskName"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"初期設定(固定値)"}}]},{"uid":"750d4c06-0a1d-42ea-a88b-32c0471b6efe","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：開始ログ取得"}}]},{"uid":"e64f78c2-3b9d-43c9-b4c6-36823e9377a2","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,$strSyoriTitle$処理開始,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]},{"uid":"010c97ad-0e32-432b-88c6-5d85d8ef9e00","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f8bed43a-7a38-4fe6-a1ef-ebec2a53cffa","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"2d5b4e31-0294-4dc4-b7ed-c7ba7d32709f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：FTPサーバ名"}}]},{"uid":"001ff9e0-3aa6-448e-9f7a-fe3822325059","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@strGFTPServerName$"}}],"returnTo":{"type":"VARIABLE","variableName":"strServerName"}},{"uid":"4b656d1d-3a2a-48b2-8cf7-9db601ec1c09","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：FTPポート"}}]},{"uid":"aff13a42-ee43-4967-9b11-8fbf2c7239fa","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$@numFTPPortNum$"}}],"returnTo":{"type":"VARIABLE","variableName":"numPortNum"}},{"uid":"b6c7185b-8169-45eb-97b3-273e6e272d85","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：FTPサーバユーザ名"}}]},{"uid":"60c64db3-dda7-4042-8872-2eb0d055d6e6","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@strGFTPUserName$"}}],"returnTo":{"type":"VARIABLE","variableName":"strUserName"}},{"uid":"971ad237-0628-4385-95a2-849c04690384","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：FTPサーバパスワード"}}]},{"uid":"4812d187-727c-4dc1-ae95-d9827f98a63c","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$@strGFTPPassword$"}}],"returnTo":{"type":"VARIABLE","variableName":"strPassword"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"変数設定(FTP情報)"}}]},{"uid":"72c207db-8a97-4fa7-8b22-634b576d0af6","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f99b9d1b-602e-4d2a-8de4-33dac4894de9","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Boxへアップロードするファイルをリスト変数へ変換"}}]},{"uid":"3534ce31-abe5-4160-8d72-95a61baf9c22","commandName":"split","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strFilePath$"}},{"name":"delimiter","value":{"type":"STRING","string":";"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"substrings","value":{"type":"STRING","string":"ALL"}}],"returnTo":{"type":"VARIABLE","variableName":"lFilePath"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Boxへ保存するファイル設定"}}]},{"uid":"5b3254fb-0529-427e-b91e-7029da4a8979","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"f16554e0-4685-4f07-b10c-b427cbb8be4a","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：FTP接続"}}]},{"uid":"797f3d57-2197-4fcc-89ac-c254cdf75fba","commandName":"connect","packageName":"Ftp","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"FtpSession"}},{"name":"serverName","value":{"type":"STRING","expression":"$strServerName$"}},{"name":"serverPort","value":{"type":"NUMBER","expression":"$numPortNum$"}},{"name":"serverType","value":{"type":"STRING","string":"ftp"}},{"name":"authenticationType1","value":{"type":"STRING","string":"username-password"}},{"name":"username1","value":{"type":"STRING","expression":"$strUserName$"}},{"name":"password1","value":{"type":"STRING","expression":"$strPassword$"}},{"name":"transferMode","value":{"type":"STRING","string":"passive"}},{"name":"transferType","value":{"type":"STRING","string":"binary"}},{"name":"defaultDirectory","value":{"type":"STRING","expression":"/$strBoxPath$"}},{"name":"isReconnectEnabled","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"6ba174b6-c3f2-4192-aa65-6b01fbbd94ee","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：Boxへ保存するファイル名を指定"}}]},{"uid":"01d9042c-4246-4859-bdb7-dbe45471d53b","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"66492aed-a113-4048-ae7f-b0dbf8fdebcb","commandName":"putFiles","packageName":"Ftp","disabled":false,"attributes":[{"name":"sessionName","value":{"type":"STRING","string":"FtpSession"}},{"name":"files","value":{"type":"STRING","expression":"$strUploadFilePath$"}},{"name":"transferType","value":{"type":"STRING","string":"binary"}}]},{"uid":"8a3a7799-c35e-4f3e-8a12-ac103d07fdc6","commandName":"delay","packageName":"Delay","disabled":false,"attributes":[{"name":"delayType","value":{"type":"STRING","string":"REGULAR"}},{"name":"delayTime","value":{"type":"NUMBER","number":"1"}},{"name":"timeUnit","value":{"type":"STRING","string":"SECONDS"}}]},{"uid":"867d365e-ea04-4205-bdee-88c04396e082","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：ログ取得"}}]},{"uid":"cc66f83b-9a8b-457f-bdb4-c344dc877ff7","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,「/$strBoxPath$」に「$strUploadFilePath$」をアップロードしました,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"strUploadFilePath"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"lFilePath"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"FTP接続&データUpload"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"処理 A(開発者設定)"}}]},{"uid":"50e85a93-dc7b-4435-bed0-3ce3aeb58e2b","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：終了ログ取得"}}]},{"uid":"69a79c6a-1166-4c23-a168-96b3c54d509f","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$strLogFilePath$"}},{"name":"logContent","value":{"type":"STRING","expression":",$strInfoLog$,$strSyoriTitle$処理終了,$strTaskName$"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[{"uid":"ffb3cb13-c1c1-4564-a720-4089ac01706f","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"5c5b8256-7c92-4e05-b462-41e8d76ca5ae","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーメッセージ編集"}}]},{"uid":"1a4cb2b7-c14f-4d4e-82e9-54a7d15d78af","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$numErrorNum$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"strErrorNum"}},{"uid":"7e2c34dc-8085-49b4-9ef0-7ae5077accf2","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strErrorLog$,$strErrorNum$ > $strErrorMsg$,$strTaskName$"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorMsg"}},{"uid":"f344b677-d08d-4337-8be8-3789c7827cf2","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","expression":"$strSystemErrorMsg$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f15474b2-39cb-4ad1-b046-38b3b8de0da4","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","expression":"$strSystemErrorMsg$"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"strErrorMsg"},"errorLineNumber":{"type":"VARIABLE","variableName":"numErrorNum"}}},{"uid":"059fb273-0efa-480f-b64a-d92c993374b0","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"32f21e9c-6a92-446a-a4f9-062ecdc046a5","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"d98b5aab-3bbb-406b-8ac2-603dc0e67520","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：FTP切断"}}]},{"uid":"97c74c3b-931d-45a7-b397-79867bcc1e71","commandName":"disconnect","packageName":"Ftp","disabled":false,"attributes":[{"name":"sessionName","value":{"string":"FtpSession","type":"STRING"}}]}],"branches":[{"uid":"c0deaa9e-9b78-4140-9283-457dea0dfe70","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"63e1ce67-cbf4-4ed5-891e-a7566550ddbd","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Info：システムエラーメッセージ編集"}}]},{"uid":"9f285403-cffa-460b-996e-c54f8869149a","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$numErrorNum$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"strErrorNum"}},{"uid":"e4e0bc04-b29c-44ca-8002-f2eb92b8a3b4","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"eaf05ab4-d8cb-414d-babf-6482bf45c4f4","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strSystemErrorMsg$/"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorMsg"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$strSystemErrorMsg$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"8ab135a3-29f3-42d1-8536-0a0d0bd83af5","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$strSystemErrorMsg$$strErrorLog$,$strErrorNum$ > $strErrorMsg$,$strTaskName$"}}],"returnTo":{"type":"VARIABLE","variableName":"strSystemErrorMsg"}},{"uid":"8f7762c6-012a-450e-a2b4-b210ca547ef4","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","expression":"$strSystemErrorMsg$"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"strErrorMsg"},"errorLineNumber":{"type":"VARIABLE","variableName":"numErrorNum"}}}]}]}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"strTaskName","description":"タスク名","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"Common_9999_CommonTask_Master0001"}},{"name":"strSyoriTitle","description":"タスク処理概要","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"子Bot標準"}},{"name":"strInfoLog","description":"ログメッセージ編集固定文(Info)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strErrorLog","description":"ログメッセージ編集固定文(Error)","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strSystemErrorMsg","description":"システムエラーメッセージ編集","type":"STRING","readOnly":false,"input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"strLogFilePath","description":"ログファイルフルパス","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strErrorMsg","description":"システムエラーメッセージ","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"numErrorNum","description":"システムエラー番号(システムエラーが発生したBot内の行数)","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"strErrorNum","description":"システムエラー番号(システムエラーが発生したBot内の行数)を文字列に変換","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strBlock","description":"タスク名置換用","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"$3"}},{"name":"strServerName","description":"FTPサーバ名","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strUserName","description":"FTPユーザ名","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strPassword","description":"FTPパスワード","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strBoxPath","description":"Boxへの保存先","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strFilePath","description":"Boxへ保存するファイルフルパス","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"numPortNum","description":"FTPポート","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"lFilePath","description":"Boxへ保存するファイルリスト","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"strUpdatePath","description":"Boxへ保存するディレクトリ先","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"strUploadFilePath","description":"Boxへ保存するファイル名(リスト)","type":"ANY","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}}],"breakpoints":[],"packages":[{"name":"Ftp","version":"2.0.0-20200624-041644"},{"name":"If","version":"2.0.0-20200721-222021"},{"name":"Step","version":"2.0.0-20200417-230833"},{"name":"ErrorHandler","version":"2.0.0-20200418-005357"},{"name":"Comment","version":"2.0.0-20200418-005342"},{"name":"System","version":"2.0.0-20200515-071729"},{"name":"LogToFile","version":"2.0.0-20200418-005423"},{"name":"MessageBox","version":"2.0.0-20200721-222213"},{"name":"List","version":"2.0.0-20200624-041923"},{"name":"Loop","version":"2.0.0-20200624-041924"},{"name":"Number","version":"2.0.0-20200418-005433"},{"name":"String","version":"3.0.0-20200418-005635"},{"name":"Delay","version":"2.1.0-20200624-041629"}],"workItemTemplateName":null}