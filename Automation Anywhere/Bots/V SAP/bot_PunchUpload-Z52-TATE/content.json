{"triggers":[],"nodes":[{"uid":"518874f6-15c2-4658-9edc-28baa963edb7","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"1f91e4ef-7060-4943-a924-20f25bf3b793","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"\\\\fs00.tdk.biz\\hqv\\VJPN_CS\\PunchUpload\\Z52 INPUT\\設定\\Mail.txtからお知らせメールアドレスゲット"}}]},{"uid":"9053c831-caa7-4c23-9f96-91cc8c65effb","commandName":"OpenCSVTXT","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"C1"}},{"name":"filePath","value":{"type":"FILE","string":"file:////fs00.tdk.biz/hqv/VJPN_CS/PunchUpload/Z52%20INPUT/設定/Mail.txt"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":true}},{"name":"delimeter","value":{"type":"STRING","string":"comma"}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":true}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":true}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}}]},{"uid":"43358d05-374f-427e-babc-e3799c1fa3e3","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"デフォルトお知らせメール宛先設定"}}]},{"uid":"e49a542e-d02d-4bc2-b088-2d15e15fb8c7","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"kniikura@jp.tdk.com"}}],"returnTo":{"type":"VARIABLE","variableName":"vMailAddress"}},{"uid":"e3d2082c-3f66-46cc-b13d-a55fc0a1d9d1","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"\\\\fs00.tdk.biz\\hqv\\VJPN_CS\\PunchUpload\\Z52 INPUT　フォルダにあるファイルを読み込んでPunch Uploadする"}}]},{"uid":"68292da0-ffdb-426b-b3ac-882069454d22","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"7939f1e5-c764-40b6-8550-4f87b3b97627","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"30fadd72-5cb3-4974-b0de-ded4206db651","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFileName{extension}$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":"xlsm"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vFileName{extension}$"}},{"name":"operator","value":{"type":"STRING","string":"NEQ"}},{"name":"value","value":{"type":"STRING","string":"xlsx"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"60c7f28d-f2b6-4567-b901-ea21ac056ff6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"PunchUploadファイルをコピーして開く"}}]},{"uid":"5be1f71a-ca0b-4b4e-bdab-12af50c72f14","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","string":"file:///C:/Ftproot/Punch_Upload_FI.xlsm"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$vUploadFolder$Bak\\."}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":true}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"a13fe0cc-4fdb-42a0-ad5a-98f99ca83730","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vUploadFolder$Bak/Punch_Upload_FI.xlsm"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":false}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"4e021b6a-f501-4017-98da-d493fc36d4c7","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Upload対象ファイルを開く"}}]},{"uid":"47c2d184-8aa0-45a3-8437-9c79264a6b8d","commandName":"OpenSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E2"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$vUploadFolder$$vFileName{name}$.$vFileName{extension}$"}},{"name":"isSpecificSheet","value":{"type":"BOOLEAN","boolean":true}},{"name":"sheetName","value":{"type":"STRING","string":"記入シート"}},{"name":"fileAccessMode","value":{"type":"STRING","string":"EDIT"}},{"name":"isSecure","value":{"type":"BOOLEAN","boolean":false}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"loadAddIns","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"08b8bac5-14df-4d91-9d90-904110a10fa8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Uploadフォーマットの識別。\n納期が　縦　か　横　か　識別し\n縦の場合だけ処理を実行する"}}]},{"uid":"4c7b0833-93d5-4a32-bbbb-589ab14d2604","commandName":"GetSingleCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E2"}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"F1"}}],"returnTo":{"type":"VARIABLE","variableName":"vCol-F1"}},{"uid":"6fc7e1ca-38e8-458d-98b4-a17d75456384","commandName":"GetSingleCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E2"}},{"name":"activeCell","value":{"type":"STRING","string":"false"}},{"name":"cell","value":{"type":"STRING","string":"G1"}}],"returnTo":{"type":"VARIABLE","variableName":"vCol-G1"}},{"uid":"21982e61-b175-418a-8d0a-902a03c77795","commandName":"if","packageName":"If","disabled":false,"children":[],"branches":[{"uid":"7f7b3908-206b-4d81-b7f3-e3517426d0d2","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"aec5a943-7f2f-463d-bb14-3d241c0fcc1d","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"56675f0f-d13e-4a1c-8288-7bf45c4cc32b","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E2"}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"a4a6bb85-d0b3-4a68-9e33-dab894741abc","commandName":"loop.commands.continue","packageName":"Loop","disabled":false}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCol-F1$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"Z52-TATE"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONALGROUP"},"groupAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCol-F1$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vCol-G1$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"得意先CD(SoldTo)*"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"operator":"AND"}},"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"87003407-e1d3-4505-8af5-e1ca04cca5cf","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"対象ファイルのP#/納期/数量が入力されてる行を読み込み"}}]},{"uid":"5b150639-d2be-45dd-afa7-c060c1955dc9","commandName":"GoToNextEmptyCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E2"}},{"name":"startFromActiveCell","value":{"type":"STRING","string":"false"}},{"name":"cellAddress","value":{"type":"STRING","string":"B6"}},{"name":"towards","value":{"type":"STRING","string":"down"}}]},{"uid":"d99e87b4-4add-4a7d-9a66-bc86277f8321","commandName":"GetSingleRowNumber","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E2"}},{"name":"activeCell","value":{"type":"STRING","string":"true"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"1c1f1ee5-5159-4375-9916-3f020d0848da","commandName":"GetMultipleCells","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E2"}},{"name":"loopSelection","value":{"type":"STRING","string":"SPECIFIC_ROWS"}},{"name":"fromRow","value":{"type":"NUMBER","number":"6"}},{"name":"toRow","value":{"type":"NUMBER","expression":"$prompt-assignment.String:toNumber$-1"}}],"returnTo":{"type":"VARIABLE","variableName":"vExcelRead"}},{"uid":"10a1b7de-652c-4a81-bbd8-d0ff69dd3b48","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"対象ファイルのHeader(SoldTo/ShipTo/PO#)を読み込み"}}]},{"uid":"cbb65886-6151-46df-9009-19c0a4b3687a","commandName":"GetMultipleCells","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E2"}},{"name":"loopSelection","value":{"type":"STRING","string":"CELL_RANGE"}},{"name":"fromCell","value":{"type":"STRING","string":"G2"}},{"name":"toCell","value":{"type":"STRING","string":"K2"}}],"returnTo":{"type":"VARIABLE","variableName":"vHeader"}},{"uid":"a6676316-748f-46fd-8da0-ba73e4ebb561","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"SoldToからお知らせメールアドレスを読み込んで宛先に追記"}}]},{"uid":"189f9fb3-6ab0-46be-8b9e-f1f9e1cb72f0","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"fd6d58ce-7403-40f5-b134-610e5e7dd723","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"3f73a690-aeff-44b6-a7b4-fbcc07806ff3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vMailAddress$,$vMailAddressList[1]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vMailAddress"}}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vHeader[0][0]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$vMailAddressList[0]$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vMailAddressList"},"attributes":[{"name":"session","value":{"type":"STRING","string":"C1"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.csvtxt","packageName":"CsvTxt"}}]},{"uid":"952d9e80-5301-4ac5-bfbb-8fefb44fe785","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"行と列番号の初期化(ループ用）"}}]},{"uid":"1ac104ad-a986-4f5b-bb23-5d576ef6de6e","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"3"}}],"returnTo":{"type":"VARIABLE","variableName":"vCount"}},{"uid":"6d871961-7255-4326-9f6f-91482e74d747","commandName":"assignToNumber","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"vRowCount"}},{"uid":"25368a4d-fd91-45b2-94f5-1a093092a313","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"6c5e6f36-4cd4-41ff-8856-451d16a93429","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"SoldTo"}}]},{"uid":"26f8fd8f-583e-497a-9fce-6583429a318c","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"A$vcount.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$vHeader[0][0]$"}}]},{"uid":"dc354f0e-499c-45ac-9927-a5608ef9b65f","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"ShipTo"}}]},{"uid":"da52f9f1-1e56-4c11-9158-8886f74ec1ed","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"B$vcount.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$vHeader[0][1]$"}}]},{"uid":"5e5094b4-860b-45c8-8477-6f826dbd198c","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"PO Number : Headerがブランクなら明細、明細がブランクならP#をセット"}}]},{"uid":"197d3c44-3bc4-4237-a955-a6b7c6f77462","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"a40a86ea-43bc-48d3-9384-56ff2c997531","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"85cb4f50-5e0d-4d47-9c55-ed8826d6d9aa","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"C$vcount.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$vExcelRead[$vRowCount$][1]$"}}]}],"branches":[{"uid":"97c2eca1-1127-4173-9844-aff056b40d1b","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"fddb62fb-b1d1-4354-a89e-6cb14d7f3d01","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"C$vcount.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$vExcelRead[$vRowCount$][4]$"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vExcelRead[$vRowCount$][4]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[{"uid":"4d83832a-a4ae-483d-95c5-f92a4cb95de2","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"f0b3eea9-5019-4e2e-8cbc-0d2bd18c3247","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"C$vcount.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$vHeader[0][2]$"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vHeader[0][2]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":""}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"f8241b75-7fe6-4219-89eb-3de5fc5f9cc0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"P#"}}]},{"uid":"4584c68d-ed8c-424c-98d2-708012ee81a4","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"D$vcount.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$vExcelRead[$vRowCount$][1]$"}}]},{"uid":"668baaa4-5fe2-4a76-94f1-e17941a0e0dc","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"納期 (【年】、【月】　→　[ / ]　へ\n      　【日】　→ [ ] ブランク ) に置換"}}]},{"uid":"34677351-0c69-4d70-bcfa-64ea01d01554","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vExcelRead[$vRowCount$][3]$"}},{"name":"find","value":{"type":"STRING","string":"年"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":"/"}}],"returnTo":{"type":"VARIABLE","variableName":"vReqDate"}},{"uid":"10366b2c-ad74-4f13-936e-e4e382fa6001","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vReqDate$"}},{"name":"find","value":{"type":"STRING","string":"月"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":"/"}}],"returnTo":{"type":"VARIABLE","variableName":"vReqDate"}},{"uid":"5a2d2afe-72db-426e-b7f0-81d39a54098e","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vReqDate$"}},{"name":"find","value":{"type":"STRING","string":"日"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"vReqDate"}},{"uid":"e6d4cdd0-6339-4adc-8863-e0aa672bd633","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"E$vcount.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$vReqDate$"}}]},{"uid":"cf6a9502-5d8f-4fce-a14c-a5fd7b55b561","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"数量 : カンマ ( , ) があったら消す"}}]},{"uid":"94dccea4-1635-44d9-984e-322b1b3c7bac","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"bfc970fc-aee5-4de2-ac8f-f05785d6de8a","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vExcelRead[$vRowCount$][2]$"}},{"name":"find","value":{"type":"STRING","string":","}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","string":""}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"65f121c0-1120-44be-8797-f679a92105b9","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"F$vcount.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$prompt-assignment$"}}]}],"branches":[{"uid":"c2666abc-53c2-4a3c-95b6-1307d3dce8ce","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"7c0167c9-60c4-4c80-b602-6bc8aba661a5","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"F$vcount.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$vExcelRead[$vRowCount$][2]$"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$vExcelRead[$vRowCount$][2]$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":","}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"9475fcb7-6a4b-454c-8911-bc52583d9403","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Item F"}}]},{"uid":"fb1f7637-71d3-4bca-8fc3-0457cd9c3dc8","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"I$vcount.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$vHeader[0][3]$"}}]},{"uid":"3f444fa4-7405-4ac7-8854-09f2e31e6596","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Customer Original - Shipping Inst 1"}}]},{"uid":"8bcfe23d-80bf-4fa6-8d38-932f5b1e183b","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","expression":"K$vcount.Number:toString$"}},{"name":"value","value":{"type":"STRING","expression":"$vHeader[0][4]$"}}]},{"uid":"8f558702-85e8-4f96-ac5c-8a6ad0a1e719","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"行と列を次へ移動（インクリメント）"}}]},{"uid":"1a49e0f5-db06-4cf9-9d0d-2c50a53f26df","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$vCount$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"vCount"}},{"uid":"8c3dc424-7a2b-47cb-810c-ffdcbc43844e","commandName":"increment","packageName":"Number","disabled":false,"attributes":[{"name":"source","value":{"type":"NUMBER","expression":"$vRowCount$"}},{"name":"by","value":{"type":"NUMBER","number":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"vRowCount"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","attributes":[{"name":"times","value":{"type":"NUMBER","expression":"$prompt-assignment.String:toNumber$-6"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.times","packageName":"Loop"}}]},{"uid":"8d0a18b7-c4a7-4f7a-a756-faccf1a19077","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"PunchUploadマクロ実行"}}]},{"uid":"19b4cff9-add5-49db-834e-c189bfdd3fba","commandName":"RunMacro","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"macroName","value":{"type":"STRING","string":"RPAupload"}},{"name":"macroArgs","value":{"type":"STRING","string":""}}]},{"uid":"c57a4e11-787f-4ee7-9b1d-5484666dc5cf","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"対象ファイルに実行時間を書き込みし、保存"}}]},{"uid":"9d7395ff-69d4-4039-afe3-bdc01dcf9b42","commandName":"SetCell","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E2"}},{"name":"cellOption","value":{"type":"STRING","string":"SPECIFIC_CELL"}},{"name":"cell","value":{"type":"STRING","string":"G20"}},{"name":"value","value":{"type":"STRING","expression":"Upload 完了 $System:Year.number:tostring$/$System:Month.number:tostring$/$System:Day.number:tostring$ $System:Hour.number:tostring$:$System:Minute.number:tostring$ に送信済み"}}]},{"uid":"c44ee684-0eac-4a9f-a8b5-ad21d4e911a0","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E1"}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"a0b8cdf0-f98b-4650-bf58-3ae31797993c","commandName":"CloseSpreadsheet","packageName":"Excel_MS","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"E2"}},{"name":"isSave","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"45b9f447-b9a8-4ce3-9a6a-7ef1cea709ee","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"処理済みファイルをBackupフォルダ（bak)へ移動"}}]},{"uid":"70e7c93e-fee0-4346-8064-48b699b43f18","commandName":"copyFiles","packageName":"File","disabled":false,"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$vUploadFolder$$vFileName{name}$.$vFileName{extension}$"}},{"name":"destinationPath","value":{"type":"STRING","expression":"$vUploadFolder$bak\\$vFileName{name}$_$System:Year.number:tostring$$System:Month.number:tostring$$System:Day.number:tostring$$System:Hour.number:tostring$$System:Minute.number:tostring$$System:Second.number:tostring$.$vFileName{extension}$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"ba8646d9-c785-45d6-8ff4-cebb423e4351","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vUploadFolder$$vFileName{name}$.$vFileName{extension}$"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"e7a3a7ed-a679-4ba4-bb5e-3bc30727510c","commandName":"renameFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$vUploadFolder$Bak/Punch_Upload_FI.xlsm"}},{"name":"newFileName","value":{"type":"STRING","expression":"$vUploadFolder$Bak\\Punch_Upload_FI_$System:Year.number:tostring$$System:Month.number:tostring$$System:Day.number:tostring$$System:Hour.number:tostring$$System:Minute.number:tostring$$System:Second.number:tostring$.xlsm"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"07379402-1723-470f-b753-a5e30278cebc","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vFileNameALL$ / $vFileName{name}$"}}],"returnTo":{"type":"VARIABLE","variableName":"vFileNameALL"}},{"uid":"27ae53db-8baa-44a9-a890-65f225fc0aca","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$vSoldToAll$ / $vHeader[0][0]$"}}],"returnTo":{"type":"VARIABLE","variableName":"vSoldToAll"}}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"vFileName"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$vUploadFolder$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}}]},{"uid":"0d408423-abdd-4136-9c83-65afd3450c68","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"cf8bfc68-2505-4ca5-96f9-f90b00f6c10b","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$vMailAddress$"}},{"name":"cc","value":{"type":"STRING","string":"seiko_ishizuka@jp.tdk.com, "}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"Z52 Upload Completed : $System:AATaskName$"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Z52 Upload　処理が実行されました\n対象得意先：　$vSoldToAll$\n対象ファイル名：　$vFileNameALL$\n\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","string":"kniikura@jp.tdk.com"}},{"name":"emailServerHost","value":{"type":"STRING","string":"px5f.jp.intdk"}},{"name":"emailServerPort","value":{"type":"NUMBER","number":"25"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$vCount$"}},{"name":"operator","value":{"type":"STRING","string":"GT"}},{"name":"value","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]}],"branches":[{"uid":"ed17af7c-b8fc-4d7d-a1fd-746d7c786ffe","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"df24f1b9-eef1-43b4-89f1-d2acb9255da9","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$vErrLineNum$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"}},{"uid":"bdd6cc42-645a-4407-9f6d-e2d25f95e816","commandName":"captureDesktop","packageName":"Screen","disabled":true,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file:////fs00.tdk.biz/hqv/VJPN_CS/PunchUpload/log/$System:AATaskName$_error.jpg"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"2376d52f-8277-44a8-931a-0a0053836daf","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","string":"kniikura@jp.tdk.com"}},{"name":"cc","value":{"type":"STRING","string":"seiko_ishizuka@jp.tdk.com"}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","expression":"Z52 Upload Error : $System:AATaskName$"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file:////fs00.tdk.biz/hqv/VJPN_CS/PunchUpload/log/$System:AATaskName$_error.jpg"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":false}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Z52 Uploadでエラーが発生しました。\n\nError Message : $vErrMsg$ .\n\nError Line number : $prompt-assignment$\n"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","string":"kniikura@jp.tdk.com"}},{"name":"emailServerHost","value":{"type":"STRING","string":"px5f.jp.intdk"}},{"name":"emailServerPort","value":{"type":"NUMBER","number":"25"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"vErrMsg"},"errorLineNumber":{"type":"VARIABLE","variableName":"vErrLineNum"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"vExcelRead","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"vHeader","description":"","type":"TABLE","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"TABLE","table":{"schema":[{"type":"STRING"}],"rows":[{"values":[{"type":"STRING","string":""}]}]}}},{"name":"vCount","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vRowCount","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vFileName","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"vUploadFolder","description":"Inputファイル格納場所","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"\\\\fs00.tdk.biz\\hqv\\VJPN_CS\\PunchUpload\\Z52 INPUT\\"}},{"name":"window-1","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Puncher Upload Program","path":"C:\\Program Files (x86)\\Microsoft Office\\Office16\\EXCEL.EXE","class":"ThunderDFrame","handle":"2560294","isChild":false,"location":{"top":500,"left":697},"size":{"height":200,"width":411},"presetType":"NONE"}}},{"name":"window-2","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"Upload confirm","path":"C:\\Program Files (x86)\\Microsoft Office\\Office16\\EXCEL.EXE","class":"#32770","handle":"4592672","isChild":false,"location":{"top":561,"left":801},"size":{"height":140,"width":219},"presetType":"NONE"}}},{"name":"vErrMsg","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vErrLineNum","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"vFileNameALL","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"window-3","description":"","type":"WINDOW","readOnly":true,"input":false,"output":false,"defaultValue":{"type":"WINDOW","window":{"name":"SAP Logon 750","path":"C:\\Program Files (x86)\\SAP\\FrontEnd\\SAPgui\\saplogon.exe","class":"#32770","handle":"69256","isChild":false,"location":{"top":248,"left":951},"size":{"height":716,"width":621},"presetType":"NONE"}}},{"name":"vSoldToAll","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vCol-F1","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vCol-G1","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"vMailAddress","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"vMailAddressList","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"vReqDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}}],"breakpoints":["19b4cff9-add5-49db-834e-c189bfdd3fba"],"packages":[{"name":"CsvTxt","version":"2.3.0-20200825-071131"},{"name":"Email","version":"2.0.0-20200721-222003"},{"name":"Excel_MS","version":"4.0.0-20200723-234413"},{"name":"If","version":"2.0.0-20200721-222021"},{"name":"ErrorHandler","version":"2.0.0-20200721-222009"},{"name":"Comment","version":"2.0.0-20200721-221948"},{"name":"System","version":"2.0.0-20200721-222454"},{"name":"Screen","version":"2.1.0-20200825-071618"},{"name":"File","version":"2.1.0-20200721-222011"},{"name":"Loop","version":"2.0.0-20200721-222213"},{"name":"Number","version":"2.0.0-20200721-222224"},{"name":"String","version":"3.0.0-20200721-222454"}],"workItemTemplateName":null}