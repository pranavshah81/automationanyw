{"triggers":[],"nodes":[{"uid":"4d162687-e24c-4da6-8b84-4ff23348dd9c","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"45c78cd3-f686-42d2-930a-0826ee2dda6f","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"93482a8f-18fc-40be-86f3-2fa48148091d","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"635a749b-a30a-48ea-8647-7eb802ad8277","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$ruta-archivo$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[{"uid":"4bcdb87e-800d-4189-b86e-bd6e1c4b56e9","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"7fc5c747-2e17-46b3-b1a3-c1fb0d0f1a3e","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$ruta-archivo$/logs/rcc$System:Year.Number:toString$$System:Month.Number:toString$$System:Day.Number:toString$"}},{"name":"logContent","value":{"type":"STRING","string":"Borrando Archivos"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"30668397-22cb-472b-b605-40170a4475ee","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"4f0c39a6-0355-445b-a225-ee189e919e88","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"acaf899f-5a20-4fbe-b640-49827205a4d9","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$Loop-Counter-1.LegacyAutomation:getIncrementedNumber.Number:toString$"}}],"returnTo":{"type":"VARIABLE","variableName":"Loop-Counter-1"}},{"uid":"573e5eb1-c512-4b6a-9456-6be0d72d6199","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$ruta-archivo$/$Loop-Files-1{name}$.$Loop-Files-1{extension}$"}},{"name":"sizeValue","value":{"type":"STRING","string":"Atleast"}},{"name":"dateValue","value":{"type":"STRING","string":"Created"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"Loop-Files-1"},"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$ruta-archivo$"}}],"value":{"type":"ITERATOR","iteratorName":"loop.iterators.files","packageName":"File"}},{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}}]}]}],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$ruta-archivo$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"5207f562-7a7d-47fe-bfc0-505f4c2ec0d4","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"6a4f4292-3801-4280-a420-2b852270a178","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$ruta-archivo$\\logs"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$ruta-archivo$\\logs"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"9fa4acd9-d7fe-4e3b-8f4f-e24392c32be5","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$ruta-archivo$/logs/rcc$System:Year.Number:toString$$System:Month.Number:toString$$System:Day.Number:toString$.log"}},{"name":"logContent","value":{"type":"STRING","string":"=======Iniciando RCC Mensual==========="}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]}],"branches":[{"uid":"0032fcbd-836b-4ace-ab47-c55f56c70948","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"c83f9e77-1244-407b-9a75-b568997e7e9b","commandName":"assign","packageName":"Boolean","disabled":false,"attributes":[{"name":"source","value":{"type":"STRING","string":"constant"}},{"name":"userDefined","value":{"type":"STRING","string":"false"}}],"returnTo":{"type":"VARIABLE","variableName":"M-IsBotExecutedSuccessfully"}},{"uid":"88099de9-38e7-463c-bb5a-9fe049f42b3b","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$ruta-archivo$/logs/rcc$System:Year.Number:toString$$System:Month.Number:toString$$System:Day.Number:toString$.log"}},{"name":"logContent","value":{"type":"STRING","expression":"Mensaje de Error: $Error-Description$\nLinea de Error: $Error-LineNumber.Number:toString$\n"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":true}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"ANSI"}}]},{"uid":"6365e073-5843-4b90-ade8-4589ac7e4b40","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$ruta-archivo$/evidencia.png"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]},{"uid":"63aec47d-2b25-4135-828b-e02e66e79849","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"1"}}],"returnTo":{"type":"VARIABLE","variableName":"unexpected-error"}},{"uid":"790724ec-6117-41c5-8668-8fd4f3b9f16d","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Migraci贸n A2019 - TCS - Inicio"}}]},{"uid":"4fce10a6-52f1-46de-9f32-8413f273fd39","commandName":"assign","packageName":"String","disabled":true,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$unexpected-error.LegacyAutomation:parseVariableOperation$"}}],"returnTo":{"type":"VARIABLE","variableName":"unexpected-error"}},{"uid":"3216d0ed-1e6f-49c8-bed8-52847d831f86","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Migraci贸n A2019 - TCS - Fin"}}]},{"uid":"4ee2a7fa-505a-4815-a11e-29272d1de455","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"Date","packageName":"System"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"MM/dd/yyyy HH:mm:ss"}}],"returnTo":{"type":"VARIABLE","variableName":"m-date-string"}},{"uid":"e811d7b9-c5c1-4a75-ae4b-489b621d8974","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Migraci贸n A2019 - TCS - Inicio"}}]},{"uid":"787bbb4d-c1c9-45ce-a8f9-ac63b0773968","commandName":"sendMail","packageName":"Email","disabled":true,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$mail-to-admin$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Automation Anywhere finished executing the TaskBot"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$ruta-archivo$/evidencia.png"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":true}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Message from Automation Anywhere.\n\nTask Name : $System:AATaskName$ \nError occurred on: $m-date-string$ \nError line number: $Error-LineNumber.Number:toString$ \nError message: $Error-Description$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$mail-from$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@AAE_EmailSettings_host$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@AAE_EmailSettings_port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","expression":"$@AAE_EmailSettings_ssl$"}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","expression":"$@AAE_EmailSettings_auth$"}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"23ac1189-a99e-46ef-8a7c-6d3295c78a9d","commandName":"sendMail","packageName":"Email","disabled":false,"attributes":[{"name":"toAddress","value":{"type":"STRING","expression":"$mail-to-admin$"}},{"name":"cc","value":{"type":"STRING","string":""}},{"name":"bcc","value":{"type":"STRING","string":""}},{"name":"subject","value":{"type":"STRING","string":"Automation Anywhere finished executing the TaskBot"}},{"name":"attachmentsFilePath","value":{"type":"FILE","expression":"file://$ruta-archivo$/evidencia.png"}},{"name":"ensureAttachmentsExist","value":{"type":"BOOLEAN","boolean":true}},{"name":"bodyFormat","value":{"type":"STRING","string":"PLAINTEXT"}},{"name":"message","value":{"type":"STRING","expression":"Message from Automation Anywhere.\n\nTask Name : $System:AATaskName$ \nError occurred on: $m-date-string$ \nError line number: $Error-LineNumber.Number:toString$ \nError message: $Error-Description$"}},{"name":"goGreen","value":{"type":"BOOLEAN","boolean":false}},{"name":"serverType","value":{"type":"STRING","string":"EMAIL_SERVER"}},{"name":"fromAddress","value":{"type":"STRING","expression":"$mail-from$"}},{"name":"emailServerHost","value":{"type":"STRING","expression":"$@gvEMail_Server_IP$"}},{"name":"emailServerPort","value":{"type":"NUMBER","expression":"$@gvEMail_Server_Port$"}},{"name":"useSecureConnection","value":{"type":"BOOLEAN","boolean":false}},{"name":"requiresAuthentication","value":{"type":"BOOLEAN","boolean":false}},{"name":"username","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}},{"name":"securedPassword","value":{"type":"CREDENTIAL","credential":{"name":"","lockerName":"","attributeName":""}}}]},{"uid":"43c745eb-997d-4b62-a49f-9bce948187fa","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"Migraci贸n A2019 - TCS - Fin"}}]},{"uid":"c64a54e8-f4f5-4581-86ce-244dfdb76c17","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"Error-Description"},"errorLineNumber":{"type":"VARIABLE","variableName":"Error-LineNumber"}}}]}],"branches":[{"uid":"981fbbbc-bae4-4232-9531-dd32be20a15e","commandName":"finally","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"4ce25803-dc10-40f3-8ac9-2dc7535b3331","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"13d7cce3-5cf8-478f-b2e6-ed4e2759975e","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}},{"name":"message","value":{"type":"STRING","string":"You chose to mark the bot as 'Failed' in case of any encountered errors."}}]}],"branches":[],"attributes":[{"name":"condition","attributes":[{"name":"variable","value":{"type":"STRING","expression":"$M-IsBotExecutedSuccessfully.Boolean:toString$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"false"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}}],"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}]}]}],"variables":[{"name":"Prompt-Assignment","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"Test-Value"}},{"name":"my-list-variable","description":"","type":"LIST","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"LIST","list":[{"type":"STRING","string":"my-value-1"},{"type":"STRING","string":"my-value-2"},{"type":"STRING","string":"my-value-3"},{"type":"STRING","string":"my-value-4"},{"type":"STRING","string":"my-value-5"}]}},{"name":"mail-to","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"mail-to-admin","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"jonathan.bc92@gmail.com,Christian.Galvez@somosoh.pe,luis.alvites@somosoh.pe"}},{"name":"unexpected-error","description":"","type":"STRING","subtype":"UNDEFINED","input":true,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"mail-from","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"operador.central@somosoh.pe"}},{"name":"ruta-archivo","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"E:\\Procesos\\RCCMensual"}},{"name":"Loop-Files","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false},{"name":"Loop-Files-1","description":"","type":"DICTIONARY","subtype":"STRING","input":false,"output":false},{"name":"Loop-Counter-1","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-Description","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false},{"name":"Error-LineNumber","description":"","type":"NUMBER","subtype":"UNDEFINED","input":false,"output":false},{"name":"M-IsBotExecutedSuccessfully","description":"","type":"BOOLEAN","subtype":"UNDEFINED","input":false,"output":false,"defaultValue":{"type":"BOOLEAN","boolean":"true"}},{"name":"m-date-string","description":"","type":"STRING","subtype":"UNDEFINED","input":false,"output":false}],"breakpoints":[],"packages":[{"name":"Boolean","version":"2.0.0-20200721-221936"},{"name":"Comment","version":"2.0.0-20200721-221948"},{"name":"Datetime","version":"2.0.0-20200721-221958"},{"name":"Email","version":"2.0.0-20200721-222003"},{"name":"ErrorHandler","version":"2.0.0-20200721-222009"},{"name":"File","version":"2.1.0-20200721-222011"},{"name":"Folder","version":"2.1.0-20200721-222013"},{"name":"If","version":"2.0.0-20200721-222021"},{"name":"LegacyAutomation","version":"2.0.0-20200721-222207"},{"name":"LogToFile","version":"2.1.0-20200721-222212"},{"name":"Loop","version":"2.0.0-20200721-222213"},{"name":"Number","version":"2.0.0-20200721-222224"},{"name":"Screen","version":"2.0.0-20200721-222442"},{"name":"String","version":"3.0.0-20200721-222454"},{"name":"System","version":"2.0.0-20200721-222454"},{"name":"TaskBot","version":"2.0.1-20200728-235256"}],"workItemTemplateName":null}